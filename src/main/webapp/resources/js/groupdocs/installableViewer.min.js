(function(a){a.widget("ui.groupdocsViewer",{_viewModel:null,options:{enableViewerInit:true,supportTextSelection:true,resourcePrefix:""},_create:function(){a.extend(this.options,{element:this.element,applicationPath:a.ui.groupdocsViewer.prototype.applicationPath,widgetInstance:this});this._viewModel=this.getViewModel()},getViewModel:function(){if(this._viewModel==null)this._viewModel=this._createViewModel();return this._viewModel},_createViewModel:function(){return new window.groupdocs.groupdocsViewerViewModel(this.options)},on:function(a,b){this.element.on(a,b)},off:function(a,b){this.element.off(a,b)},setWidth:function(a){this._viewModel.setWidth(a)},setHeight:function(a){this._viewModel.setHeight(a)},openNextPage:function(){this._viewModel.openNextPage()},openPreviousPage:function(){this._viewModel.openPreviousPage()},setPage:function(a){this._viewModel.setPage(a)},openFirstPage:function(){this._viewModel.openFirstPage()},openLastPage:function(){this._viewModel.openLastPage()},showFileBrowser:function(){this._viewModel.showFileBrowser()},setViewerMode:function(a){this._viewModel.setViewerMode(a)},zoomIn:function(){this._viewModel.zoomIn()},zoomOut:function(){this._viewModel.zoomOut()},setZoom:function(a){this._viewModel.setZoom(a)},downloadDocument:function(){this._viewModel.downloadDocument()},printDocument:function(){this._viewModel.printDocument()},searchForward:function(d,c,b,a){this._viewModel.searchForward(d,c,b,a)},searchBackward:function(d,c,b,a){this._viewModel.searchBackward(d,c,b,a)},clearSearchValue:function(){this._viewModel.clearSearchValue()},getDocumentPageCount:function(){return this._viewModel.getDocumentPageCount()},loadDocument:function(a){this._viewModel.loadDocument(a)},destroy:function(){this._viewModel.destroy()}});if(!window.groupdocs)window.groupdocs={};window.groupdocs.groupdocsViewerViewModel=function(b){a.extend(this,b);this._create(b)};a.extend(window.groupdocs.groupdocsViewerViewModel.prototype,{groupdocsViewerWrapper:null,browserIsInternetExplorer:false,resizeTimeoutId:null,viewModes:{ScrollMode:1,BookMode:2},viewMode:null,licElement:null,_create:function(a){this._model=new b(a);this._init(a)},_init:function(C){var c,d=this.element,b=a.extend({hostUrl:this.applicationPath,docViewerId:"docViewer"+window.groupdocs.viewerId},C);window.groupdocs.viewerId++;if(C.enableViewerInit){var f,z=false;if(a.browser.msie){this.browserIsInternetExplorer=true;if(a.browser.version==8)z=true;f=".grpdx input[type='text']::-ms-clear {display: none;}";a("<style>"+f+"</style>").appendTo("head")}var k="grpdx"+b.docViewerId,e=this,s="";if(e.browserIsInternetExplorer&&b.useHtmlBasedEngine){s=" ie";if(z)s+=" ie8"}var O="";if(!b.showHeader)O='style="display: none"';d.each(function(){a('<div class="groupdocs_viewer_wrapper grpdx '+k+'"><div class="viewer_header header_sidescroll" '+O+'>   <div class="viewer_header_wrapper">      <a class="btnOpen new_head_tools_btn h_t_i_browser" data-tooltip="Open File" data-localize-tooltip="OpenFile"></a>      <div name="printAndDownloadToolbar" class="new_head_tools_wrapper left">          <a class="new_head_tools_btn h_t_i_download btn_download" data-tooltip="Download" data-localize-tooltip="Download"></a>          <a class="new_head_tools_btn h_t_i_print print_button" data-tooltip="Print" data-localize-tooltip="Print"></a>      </div>      <div class="navigation-bar'+(z?" ie8":"")+'">      </div>      <div class="new_head_tools_wrapper zoom_wrappper">      </div>      <div class="new_head_tools_dropdown_wrapper viewTypeMenu">\t\t\t<a class="new_head_tools_btn head_tool_dropdown_btn h_t_i_singlepage" data-bind="click: toggleDropDownMenu" href="#" data-tooltip="View Mode" data-localize-tooltip="ViewMode"></a>\t\t\t<ul class="dropdown-menu head_tool_dropdown" style="min-width: 142px; display: none;" data-bind="style: {display: (dropDownMenuIsVisible() ? \'block\' : \'none\')}">\t\t\t\t<li style="display: inline">\t\t\t\t\t<a data-bind="click: openScrollView" href="#">\t\t\t\t\t\t<span class="h_t_d_i_scroll"></span>\t\t\t\t\t\t<p data-localize="ScrollView">Scroll View</p>\t\t\t\t\t</a>\t\t\t\t</li>\t\t\t\t<li style="display: inline">\t\t\t\t\t<a data-bind="click: openDoublePageFlipView" href="#">\t\t\t\t\t\t<span class="h_t_d_i_double"></span>\t\t\t\t\t\t<p data-localize="BookMode">Double Page Flip</p>\t\t\t\t\t</a>\t\t\t\t</li>\t\t\t</ul>\t\t</div>      <div name="search_wrapper" class="new_head_tools_wrapper" data-bind="visible:visible">      </div>'+(b.supportPageRotation?'<div class="new_head_tools_wrapper">      <a name="rotateClockwise" class="h_t_i_rotatecl new_head_tools_btn" data-tooltip="Rotate Clockwise" data-localize-tooltip="RotateClockwise"></a>      <a name="rotateCounterClockwise" class="h_t_i_rotatecon new_head_tools_btn" data-tooltip="Rotate Counter-Clockwise" data-localize-tooltip="RotateCounterClockwise"></a></div>':"")+'   </div></div><div class="fileOpenDialogWrapper" style="display: none"></div><div class="viewer_mainwrapper '+s+'">   <div id='+b.docViewerId+' class="doc_viewer" data-bind="event: { scroll: function(item, e) { this.ScrollDocView(item, e); }, scrollstop: function(item, e) { this.ScrollDocViewEnd(item, e);e.returnValue = false;return true; } }">   </div>   <div class="doc_viewer_wrapper_page_flip" style="overflow: auto; top: -50000px; position: absolute;height: 100%">   </div>'+(b.showThumbnails?'   <a class="thumbs_btn" href="#"></a>':"")+'</div><div name="jGDerror" class="modal_dialog_wrapper jerrorwrapper">   <div class="modal_dialog_overlay">       &nbsp;   </div>   <div class="modal_dialog_content_wrapper">       <div class="modal_dialog_header">          Error       </div>       <div class="modal_dialog_content">       </div>   </div></div></div>').appendTo(a(this))})}this.groupdocsViewerWrapper=c=d.find(".groupdocs_viewer_wrapper");var N=this.viewerHeader=c.find(".viewer_header"),i=this.viewerMainWrapper=c.find(".viewer_mainwrapper");if(!b.showHeader){N.height(0);i.css("top","0")}if(!C.enableViewerInit)return;if(b.filePath=="")b.openThumbnails=false;if(b.useHtmlBasedEngine)b.showViewerStyleControl=false;var G="#"+b.docViewerId,l=a(G),L=c.find("[name='search_wrapper']"),q,A;if(b.width)q=b.width;else q=d.width();c.width(q);if(b.height)A=b.height;else A=d.height();c.height(A);var o=null;if(!b.useHtmlBasedEngine){o=c.find("[name='selection-content']");if(o.length==0)o=a("<textarea readonly='readonly' rows='1' cols='1' name='selection-content'></textarea>'").appendTo(c)}var Q=c.find("[name='jGDerror']");Q.find(".modal_dialog_overlay").click(function(){Q.hide()});var w=c.find(".navigation-bar"),y=c.find(".zoom_wrappper"),D=c.find(".doc_viewer_wrapper_page_flip"),u=this.fileOpenDialogWrapper=c.find(".fileOpenDialogWrapper");if(!b.supportTextSelection){var T=G+" .ui-selectable-helper {display: none;visibility: hidden}";a("<style>"+T+"</style>").appendTo("head")}var v;if(b.thumbnailsContainerWidth){var W=203,S=150,R=187,I=this.getScrollbarWidth(),t=Math.round(b.thumbnailsContainerWidth),P=(W-I)/(t-I);v=Math.round(S/P);var U=Math.round(R/P);f="div.thumbnailsContainer{width:"+t+"px}";f+="div.thumbnailsContainer ul li img{width:"+v+"px}";f+="div.thumbnailsContainer ul li{min-width:"+U+"px}";f+=".thumbs_btn_slide{left:"+(t+2)+"px}";a("<style>"+f+"</style>").appendTo("head")}f="";if(b.searchHighlightColor)f+="."+k+" .search_highlight_html, ."+k+" .search-highlight {background-color:"+b.searchHighlightColor+"}";if(b.currentSearchHighlightColor)f+=".grpdx."+k+" .current_search_highlight {background-color:"+b.currentSearchHighlightColor+"}";if(b.showOnePageInRow)f+=".grpdx."+k+" .doc-page {display:block; margin-left:auto; margin-right:auto;}";if(b.useEmScaling)f+=".grpdx."+k+" .html_page_contents {transform-origin:initial}";f&&a("<style>"+f+"</style>").appendTo("head");function j(){e._localizeElements()}l.bind("onHtmlCreated",j);w.bind("onHtmlCreated",j);y.bind("onHtmlCreated",j);D.bind("onHtmlCreated",j);u.bind("onHtmlCreated",j);var Z={createHtml:true,viewerElement:l,useCaseSensitiveSearch:b.useCaseSensitiveSearch,searchForSeparateWords:b.searchForSeparateWords,treatPhrasesInDoubleQuotesAsExactPhrases:b.treatPhrasesInDoubleQuotesAsExactPhrases,useHtmlBasedEngine:b.useHtmlBasedEngine,searchIsVisible:b.showSearch},X={createHtml:true,thumbnailWidth:v,quality:100,useHtmlBasedEngine:b.useHtmlBasedEngine&&b.useHtmlThumbnails,useInnerThumbnails:b.useInnerThumbnails,supportPageReordering:b.supportPageReordering,use_pdf:b.supportTextSelection?"true":"false",supportPageRotation:b.supportPageRotation},r;if(b.showThumbnails)if(b.useInnerThumbnails)r=i;else r=i;else r=null;var ab={watermarkText:b.watermarkText,watermarkColor:b.watermarkColor,watermarkPosition:b.watermarkPosition,watermarkWidth:b.watermarkFontSize,preventTouchEventsBubbling:b.preventTouchEventsBubbling,searchForSeparateWords:b.searchForSeparateWords,treatPhrasesInDoubleQuotesAsExact:b.treatPhrasesInDoubleQuotesAsExact,usePngImagesForHtmlBasedEngine:b.usePngImagesForHtmlBasedEngine,alwaysOnePageInRow:b.showOnePageInRow,onlyShrinkLargePages:b.onlyShrinkLargePages,loadAllPagesOnSearch:b.loadAllPagesOnSearch,useEmScaling:b.useEmScaling,convertWordDocumentsCompletely:b.convertWordDocumentsCompletely,ignoreDocumentAbsence:b.ignoreDocumentAbsence,usePdf:b.supportTextSelection,preloadPagesOnBrowserSide:b.preloadPagesOnBrowserSide,supportPageRotation:b.supportPageRotation},Y="onMenuClicked",B=c.find(".viewTypeMenu"),n={dropDownMenuIsVisible:ko.observable(false),dropDownMenuClicked:false,openScrollView:function(){e.openScrollView()},openDoublePageFlipView:function(){e.openDoublePageFlipView()},showDropDownMenu:function(a){this.dropDownMenuIsVisible(a)},toggleDropDownMenu:function(b,a){this.dropDownMenuIsVisible(!this.dropDownMenuIsVisible());this.dropDownMenuClicked=true;B.trigger(Y);a.stopPropagation()}},M=this.viewerAdapter=new DocViewerAdapter({fileId:b.filePath,fileVersion:"0",quality:b.quality,use_pdf:b.supportTextSelection?"true":"false",docSpace:l,_mode:"webComponent",createHtml:true,initialZoom:b.initialZoom,viewerWidth:q,viewerHeight:i.height(),docViewerId:b.docViewerId,zoomToFitWidth:b.zoomToFitWidth,zoomToFitHeight:b.zoomToFitHeight,navigation:w,navigationOptions:{createHtml:true},thumbnails:r,thumbnailsOptions:X,zooming:y,zoomingOptions:{createHtml:true},search:L,searchOptions:Z,preloadPagesCount:b.preloadPagesCount,docSpacePageFlip:b.useHtmlBasedEngine||b.viewerStyle==this.viewModes.ScrollMode&&!b.showViewerStyleControl?null:D,viewerStyle:b.viewerStyle,usePageNumberInUrlHash:false,selectionContent:o,imageHorizontalMargin:14,imageVerticalMargin:14,useJavaScriptDocumentDescription:true,searchPartialWords:true,variableHeightPageSupport:true,textSelectionSynchronousCalculation:false,minimumImageWidth:b.minimumImageWidth,fileDisplayName:b.fileDisplayName,pageContentType:b.useHtmlBasedEngine?"html":"image",searchExactText:b.searchExactText,viewerOptions:ab,viewTypeMenu:B,viewTypeViewModel:n});if(b.showFolderBrowser){var V={hostUrl:b.hostUrl,userId:b.userId,userKey:b.userKey,fileExplorer:c.find(".file_browser_content"),fileUploader:c.find(".file_browser_toolbar"),resourcePrefix:b.resourcePrefix,urlHashEnabled:false};u.fileOpenDialog(V);u.find(".popclose").click(function(){e._hideFileOpenDialog()})}j();var p=d.find(".thumbs_btn");b.useInnerThumbnails&&p.hide();function J(){b.showThumbnails&&b.thumbsImageBase64Encoded!=null&&p.css("background-image","url(data:image/png;base64,"+b.thumbsImageBase64Encoded+")").css("background-position","0 0")}J();p.click(function(){a(this).toggleClass("thumbs_btn_slide");d.find(".thumbnailsContainer").toggle();if(a.browser.msie){p.css("background-image","");J()}return false});c.find(".btnOpen").click(function(){e._showFileOpenDialog()});c.find("[name=rotateClockwise]").click(function(){e._rotatePage(90)});c.find("[name=rotateCounterClockwise]").click(function(){e._rotatePage(-90)});c.find(".file_browser_content").bind("fileSelected",function(b,a){e._hideFileOpenDialog();e.fileDisplayName=M.docViewerViewModel.fileDisplayName="";M.docViewerViewModel.loadDocument(a.guid)});if(b.showThumbnails&&b.openThumbnails){d.find(".thumbs_btn").addClass("thumbs_btn_slide");d.find(".thumbnailsContainer").css("display","block")}ko.applyBindings(n,B.get(0));a("html").click(function(){e.viewerAdapter.zoomViewModel&&e.viewerAdapter.zoomViewModel.showDropDownMenu(false);n.showDropDownMenu(false)});if(b.backgroundColor){d.find(".groupdocs_viewer_wrapper").css("background-color",b.backgroundColor);N.css("background-color",b.backgroundColor);d.find(".new_head_input").css("background-color",b.backgroundColor);d.find(".new_head_tools_wrapper").css("background-color",b.backgroundColor).css("box-shadow","none");d.find(".thumbs_btn").css("background-color",b.backgroundColor)}d.find(".btnOpen").css("display",b.showFolderBrowser?"":"none");d.find(".navigation-bar").css("display",b.showPaging?"":"none");y.css("display",b.showZoom?"":"none");d.find(".btn_download").css("display",b.showDownload?"":"none");d.find(".print_button").css("display",b.showPrint?"":"none");d.find(".viewTypeMenu").css("display",b.showViewerStyleControl?"":"none");b.showPrint===false&&b.showDownload===false&&d.find("[name='printAndDownloadToolbar']").css("display","none");b.showSearch===false&&L.css("display","none");function K(e,d,f){for(var c=["-moz-","-webkit-",""],a=e+"{",b=0;b<c.length;b++)a+=c[b]+d+":"+f+";";a+="}";return a}var g="";if(b.toolbarButtonsBoxShadowStyle){var F="box-shadow",x=K(".grpdx .new_head_tools_btn",F,b.toolbarButtonsBoxShadowStyle);g+=x;if(b.toolbarButtonsBoxShadowHoverStyle){x=K(".grpdx .new_head_tools_btn:hover",F,b.toolbarButtonsBoxShadowHoverStyle);g+=x}}if(b.thumbnailsContainerBackgroundColor)g+=".grpdx div.thumbnailsContainer{background-color:"+b.thumbnailBackgroundColor+"}\r\n";if(b.toolbarBorderBottomColor)g+=".grpdx .viewer_header{border-bottom-color:"+b.toolbarBorderBottomColor+"}\r\n";if(b.thumbnailsContainerBorderRightColor)g+=".grpdx div.thumbnailsContainer{border-right-color:"+b.thumbnailsContainerBorderRightColor+"}\r\n";if(b.toolbarInputFieldBorderColor)g+=".grpdx .new_head_input{border-color:"+b.toolbarInputFieldBorderColor+"}\r\n";if(b.toolbarButtonBorderColor)g+=".grpdx .new_head_tools_btn{border-color:"+b.toolbarButtonBorderColor+"}\r\n";if(b.useInnerThumbnails)g+=".grpdx #"+b.docViewerId+"{display: inline-block}\r\n";a("<style>"+g+"</style>").appendTo("head");l.bind("onDocumentLoadComplete",function(b,a){e.documentLoadCompleteHandler(a,c,i)});l.bind("onDocumentLoaded",function(b,a){e.documentLoadedHandler(a,c,i)});l.bind("isDocumentSinglePaged.groupdocs",function(b,a){e.documentSinglePagedHandler(a,w)});if(b.viewerStyle==this.viewModes.BookMode)n.openDoublePageFlipView();else this.viewMode=this.viewModes.ScrollMode;var m=c.find("[name='jGDerror']"),E=m.find(".modal_dialog_content"),h=m.find(".modal_dialog_content_wrapper");m.removeClass("jerrorwrapper");var H=c.find(".viewer_mainwrapper"),bb=false;window.jGDError=function(c){a(d).trigger("error.groupdocs",c);if(b.enableStandardErrorHandling){c=c.replace(/^[\r\n\s]+|[\r\n\s]+$/g,"");if(!c)c="Sorry, we're unable to perform your request right now. Please try again later.";m.css("height","auto");var e,f;if(c.substring(0,1)=="<"){E.html(c);var i=H.width(),g=H.height();if(i<100)e=i;else e=i-100;if(g<100)f=g;else f=g-100}else E.text(c);if(e!=undefined){h.css("margin-left",-e/2);h.width(e)}f!=undefined&&h.height(f);m.show();h.css("margin-left",-h.width()/2);h.css("margin-top",-h.height()/2)}};this.resizeHandler()},documentLoadedHandler:function(d,b,c){this.printFrameLoaded=false;if(!d.lic&&b.find(".licBanner").length==0){c.addClass("viewer_mainwrapper_trial");this.licElement=a("<div/>");this.licElement.addClass("banner_trial");!this.showHeader&&this.licElement.css("top","0");this.licElement.html("This viewer has been created using an unlicensed version of <a href='http://groupdocs.com' target='_blank'>GroupDocs</a> Viewer for .NET ");this.licElement.appendTo(b);!this.showHeader&&c.css("top",this.licElement.height()+"px")}},documentLoadCompleteHandler:function(a,b){var e=this;this.showImageWidth&&alert("Image width: "+a.page_size.Width);this.downloadUrl=a.url;this.pdfDownloadUrl=a.pdfDownloadUrl;this.pdfPrintUrl=a.pdfPrintUrl;this.documentPath=a.guid;var c=b.find(".btn_download"),d=b.find(".print_button");c.unbind();d.unbind();var f=this.groupdocsViewerWrapper.find("iframe[name=groupdocsPrintFrame]");f.remove();c.bind({click:function(){e._downloadDocument();return false}});d.bind({click:function(){e._printDocument();return false}})},documentSinglePagedHandler:function(b,a){if(this.showPaging)if(b)a.hide();else a.show()},_localizeElements:function(){var b=this;this.localizedStrings!=null&&b.element.find("[data-localize],[data-localize-ph],[data-localize-tooltip]").each(function(){var e=a(this),c=e.attr("data-localize"),d;if(c){d=b.localizedStrings[c];e.text(d)}else{c=e.attr("data-localize-ph");if(c){d=b.localizedStrings[c];e.attr("placeholder",d)}else{c=e.attr("data-localize-tooltip");if(c){d=b.localizedStrings[c];e.attr("data-tooltip",d)}}}})},getScrollbarWidth:function(){var c=null,d=a("<div/>").css("width","100px").css("height","100px").css("overflow","scroll").css("position","absolute").css("top","-9999px"),b=d[0];document.body.appendChild(b);c=b.offsetWidth-b.clientWidth;document.body.removeChild(b);return c},resizeHandler:function(){var c=false;if(this.showHeader){var a=this.viewerHeader.outerHeight(true);if(a!=this.viewerMainWrapper.position().top){var b=a.toString()+"px";this.viewerMainWrapper.css("top",b);this.licElement&&this.licElement.css("top",b);if(this.viewMode==this.viewModes.ScrollMode)this.viewerAdapter.docViewerViewModel.reInitSelectable();else this.viewerAdapter.docViewerPageFlipViewModel.reInitSelectable();c=true}}if(this.viewMode==this.viewModes.ScrollMode&&this.useInnerThumbnails)this.viewerAdapter.docViewerViewModel.resizeViewerElement();else this.viewerAdapter.docViewerViewModel.loadImagesForVisiblePages()},resizeHandlerWithDelay:function(){this.resizeTimeoutId&&clearTimeout(this.resizeTimeoutId);var a=this;this.resizeTimeoutId=window.setTimeout(function(){a.resizeHandler()},1e3)},setWidth:function(a){this.groupdocsViewerWrapper.width(a);this.resizeHandler();this.resizeHandlerWithDelay()},setHeight:function(a){this.groupdocsViewerWrapper.height(a);this.resizeHandler();this.resizeHandlerWithDelay()},_showFileOpenDialog:function(){var b=this;this.fileOpenDialogWrapper.addClass("in");this.fileOpenDialogWrapper.show();this.backdrop=a('<div class="modal-backdrop fade" />').appendTo(this.groupdocsViewerWrapper),this.backdrop.click(function(){b._hideFileOpenDialog()});this.backdrop.addClass("in")},_rotatePage:function(a){this.viewerAdapter.docViewerViewModel.rotatePage(a)},_hideFileOpenDialog:function(){this.backdrop.removeClass("in");this.backdrop.remove();this.fileOpenDialogWrapper.hide()},openScrollView:function(){var b=this.groupdocsViewerWrapper.find(".doc_viewer"),a=this.groupdocsViewerWrapper.find(".doc_viewer_wrapper_page_flip");a.css("position","absolute");a.css("height","100%");a.hide();b.show();this.viewerAdapter.docViewerViewModel.openCurrentPage();this.viewerAdapter.docViewerViewModel.reInitSelectable();if(this.viewerAdapter.zooming){this.viewerAdapter.zoomViewModel.setFitWidthZoom(this.viewerAdapter.docViewerViewModel.getFitWidthZoom());this.viewerAdapter.zoomViewModel.setFitHeightZoom(this.viewerAdapter.docViewerViewModel.getFitHeightZoom())}this.viewerAdapter.search&&this.viewerAdapter.searchViewModel.showControls();this.viewMode=this.viewModes.ScrollMode},openDoublePageFlipView:function(){if(!this.useHtmlBasedEngine){var b=this.groupdocsViewerWrapper.find(".doc_viewer"),a=this.groupdocsViewerWrapper.find(".doc_viewer_wrapper_page_flip");a.show();this.viewerAdapter.docViewerPageFlipViewModel.openCurrentPage();a.css("height","");a.css("top","");a.css("position","");b.hide();this.viewerAdapter.docViewerPageFlipViewModel.reInitSelectable();if(this.viewerAdapter.zooming){this.viewerAdapter.zoomViewModel.setFitWidthZoom(this.viewerAdapter.docViewerPageFlipViewModel.getFitWidthZoom());this.viewerAdapter.zoomViewModel.setFitHeightZoom(this.viewerAdapter.docViewerPageFlipViewModel.getFitHeightZoom())}this.viewerAdapter.search&&this.viewerAdapter.searchViewModel.hideControls();this.viewMode=this.viewModes.BookMode}},_downloadDocument:function(){this.element.trigger("onGDViewerDownloadButtonClick");this.element.trigger("downloadButtonClick.groupdocs");var b=this.downloadUrl;if(this.downloadPdfFile)b=this.pdfDownloadUrl;if(this.showDownloadErrorsInPopup)a.fileDownload(b,{failCallback:function(a){window.jGDError(a)},cookieName:self.jqueryFileDownloadCookieName,containerElement:this.groupdocsViewerWrapper});else window.location.href=b;return false},_printDocument:function(){if(this.usePdfPrinting)var m=window.open(this.pdfPrintUrl);else{var e="";if(this.fileDisplayName)e=this.fileDisplayName;var l=this;function f(){b[0].contentWindow.focus();b[0].contentWindow.print()}var c=this.useHtmlBasedEngine&&!this.useImageBasedPrinting,b=this.groupdocsViewerWrapper.find("iframe[name=groupdocsPrintFrame]"),h=null,g=null,i=this.watermarkPosition,d=null;if(this.printWithWatermark){h=this.watermarkText;g=this.watermarkColor;d=this.watermarkFontSize}if(b.length==0){var k=500,j=500;b=a("<iframe name='groupdocsPrintFrame' src='about:blank' style='width:"+k+"px;height:"+j+"px'></iframe>");b.appendTo(this.groupdocsViewerWrapper);this._model.getPrintableHtml(this.documentPath,c,e,h,g,i,d,function(d){var a=b[0].contentWindow.document;b.load(function(){l.printFrameLoaded=true;if(c)window.setTimeout(function(){f()},10);else f()});a.open();a.write(d);a.close()},function(){})}else if(this.printFrameLoaded)f();else this._model.getPrintableHtml(this.documentPath,c,e,h,g,i,d,function(c){var a=b[0].contentWindow.document;a.open();a.write(c);a.close()},function(){})}return false},openNextPage:function(){this.viewerAdapter.navigationViewModel.down()},openPreviousPage:function(){this.viewerAdapter.navigationViewModel.up()},setPage:function(a){this.viewerAdapter.navigationViewModel.selectPage(a)},openFirstPage:function(){this.viewerAdapter.navigationViewModel.openFirstPage()},openLastPage:function(){this.viewerAdapter.navigationViewModel.openLastPage()},showFileBrowser:function(){this._showFileOpenDialog()},setViewerMode:function(a){if(a==0)this.openScrollView();else this.openDoublePageFlipView()},zoomIn:function(){this.viewerAdapter.zoomViewModel.zoomIn()},zoomOut:function(){this.viewerAdapter.zoomViewModel.zoomOut()},setZoom:function(b){var a=b;switch(b){case window.groupdocs.FitWidth:a=this.viewerAdapter.zoomViewModel.getFitWidthZoomValue();break;case window.groupdocs.FitHeight:a=this.viewerAdapter.zoomViewModel.getFitHeightZoomValue()}this.viewerAdapter.zoomViewModel.setZoom({value:a})},downloadDocument:function(){this._downloadDocument()},printDocument:function(){this._printDocument()},searchForward:function(a,d,c,b){if(this.viewerAdapter.searchViewModel.searchValue()!=a)this.viewerAdapter.searchViewModel.searched=false;this.viewerAdapter.searchViewModel.searchValue(a);this.viewerAdapter.searchViewModel.findNext(d,c,b)},searchBackward:function(a,d,c,b){if(this.viewerAdapter.searchViewModel.searchValue()!=a)this.viewerAdapter.searchViewModel.searched=false;this.viewerAdapter.searchViewModel.searchValue(a);this.viewerAdapter.searchViewModel.findPrevious(d,c,b)},clearSearchValue:function(){this.viewerAdapter.searchViewModel.clearValue()},getDocumentPageCount:function(){return this.viewerAdapter.docViewerViewModel.pageCount()},loadDocument:function(a){this.viewerAdapter.docViewerViewModel.loadDocument(a)},destroy:function(){var b=this.groupdocsViewerWrapper.find(".doc_viewer_wrapper_page_flip .pages_container_flip");b.length!=0&&b.turn("is")&&b.turn("destroy");this.groupdocsViewerWrapper.remove();a.Widget.prototype.destroy.call(this.widgetInstance)}});var b=function(b){a.extend(this,b);this._init()};a.extend(b.prototype,{_portalService:null,_init:function(){this._portalService=Container.Resolve("PortalService")},getPrintableHtml:function(h,a,d,g,e,c,b,i,f){this._portalService.getPrintableHtml(h,a,d,g,e,c,b,function(a){i.apply(this,[a.data])},function(a){f.apply(this,[a])})}});a.support.cors=true;if(!jQuery.browser){jQuery.browser={};(function(){jQuery.browser.msie=false;jQuery.browser.version=0;if(navigator.appName=="Microsoft Internet Explorer"){if(navigator.userAgent.match(/MSIE ([0-9]+)\./)){jQuery.browser.msie=true;jQuery.browser.version=RegExp.$1}}else if(navigator.appName=="Netscape"){var b=navigator.userAgent,a=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");if(a.exec(b)!=null){jQuery.browser.msie=true;jQuery.browser.version=RegExp.$1}}})()}window.groupdocs.ScrollMode=0;window.groupdocs.BookMode=1;window.groupdocs.FitWidth=-1;window.groupdocs.FitHeight=-2;window.groupdocs.viewerId=1})(jQuery);